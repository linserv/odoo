name: sync-fork
on:
  schedule:
    - cron: '0 0 * * 5' # Every Friday at 00:00 UTC
  workflow_dispatch:
    inputs:
      branch:
        description: 'Specific branch to sync (leave empty for all)'
        required: false
        type: string

jobs:
  sync:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    strategy:
      matrix:
        branch: 
          - 18.0
          - 17.0
          - 16.0
          - 15.0
      fail-fast: false
    steps:
      - name: Sync branch ${{ matrix.branch }}
        if: ${{ github.event.inputs.branch == '' || github.event.inputs.branch == matrix.branch }}
        run: |
          echo "ðŸ”„ Syncing branch: ${{ matrix.branch }}"
          gh repo sync ${{ github.repository }} -b ${{ matrix.branch }}
          echo "âœ… Branch ${{ matrix.branch }} synced!"
        env:
          GH_TOKEN: ${{ secrets.LINSERV_FORK_SYNC_PAT }}
